---
title: 
date: 2023-01-05 02:55:07
permalink: /pages/a97f13/
---
# **第五章  [BX]和loop指令**
**1. [bx]和内存单元的描述**  


[bx]表示一个**内存单元**，该内存单元的段地址位于ds中，偏移地址位于bx中。
该内存单元的完整地址为： ds*16 + bx。

**2. loop**

循环指令。指令格式为：loop 标号  
该指令分两步执行。  

第一步，计算 cx = cx -1  
第二步，判断cx中的值，不为零则跳转至标号出执行程序，如果为零则向下执行。

**3. 我们定义的描述性的符号：“（）”**

“（）”表示一个内存单元或寄存器的内容。也即是存储器中存储的值。

“（）”中的元素可以有3中类型：寄存器名、段寄存器名、内存单元的物理地址（一个20位数据）。

**4. 约定符号idata表示常量**

在以后的学习中我们约定idata表示一个常量。

## **5.1 [BX]**

[bx]表示一个**内存单元。**

mov ax, [bx] 代码的含义：将ds:bx所指向内存单元的内容放入ax寄存器中。即：(ax)=((ds*16)+(bx))

mov [bx], ax 代码的含义：将ax中的内容放入ds:bx所指向的内存单元中。即：((ds*16)+(bx))=(ax)

## **5.2 Loop指令**

首先loop指令的格式是：loop 标号。该指令分两步执行：

第一步， 计算cx = cx - 1；  
第二步，判断cx中的值，不为零则跳转至标号处执行程序，如果为零则向下执行。

一般使用loop指令实现循环功能。格式如下：

```c
    mov cx, n
s:  add ax, ax
    loop s
```

以上代码会循环执行n次。（n >= 0）

## **5.3 在Debug中跟踪用loop指令实现的循环程序**

使用Debug调试程序时，有几条经常用到的指令。

**T指令**，单步执行指令。

**g指令**, 跳至断点，从当前IP执行至指定IP处。"g 0012"表示程序由当前位置执行至DS:0012处。

**p指令**，循环执行指令，p指令用于执行完当前次数。

## **5.4 Debug和汇编编译器masm对指令的不同处理**

Debug和汇编编译器masm对形如“mov ax, [0]”这类指令的处理是不同的。debug将"[0]"看做是一个内存单元，该内存单元的地址是 ds*6 + 0。而编译器直接将“[0]”看做立即数0。因此有如下约定。

（1）在汇编源程序中，如果指令访问一个内存单元，则在指令中必须用"[...]"来表示内存单元，如果在“[...]”里用一个常量idata直接给出内存单元的偏移地址，就要在“[]”的前面显式的给出段地址所在的段寄存器。

（2）如果在“[]”里面用寄存器，比如bx,间接给出内存单元的偏移地址，则段地址默认在ds中。当然，也可以显式的给出段地址所在的段寄存器。

以上两点概括来说就是，如果内存单元的偏移地址使用立即数给出，则必须显式指明其段地址所在的段寄存器。

## **5.5 loop和[bx]的联合应用**

通过loop和[bx]联合应用实现对连续内存单元的操作实例：

```c
    ...
    mov bx, 0
    mov cx, 50

s:  mov ax, [bx]
    inc bx
    loop s
    ...
```

以上代码通过循环实现了对内存单元DS:0000H~DS:0032H内容的操作。

## **5.6段前缀**

如果内存单元的偏移地址由bx给出，如“mov ax, [bx]”，则段地址默认位于ds中。我们也可以在访问内存单元的指令中显式的给出内存单元段地址所在的段寄存器。比如：

（1）mov ax, ds:[bx]  
（2）mov ax, cs:[bx]  
（3）mov ax, ss:[bx]  
（4）mov ax, cs:[bx]  
（5）mov ax, ss:[0]  
（6）mov ax, cs:[0]

这些出现在访问内存单元的指令中，用于显式的指明内存单元的段地址的“ds:”、“cs:”、“ss:”、“es:”，在汇编语言中称为**段前缀**。

## **5.7 一段安全的空间**

（1）我们需要直接向一段内存汇总写入内容；

（2）这段内存空间不应当存放系统或其他程序的数据或代码，否则写入操作很可能引发错误；

（3）DOS方式下，一般情况，0:200~0:2ff空间中没有系统或其他程序的数据或代码；

（4）以后，我们需要直接向一段内存中写入内容时，就使用0:200~0:2ff这段空间。

## **5.8 段前缀的使用**

当需要操作的内存空间跨段时，显式的使用段前缀给出内存单元的段地址，可以避免在循环中对ds的重复设置。

也即是说一个内存单元的段地址不仅仅可以由ds给出，也可以通过cs、ss、es给出。

---

